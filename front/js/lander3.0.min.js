"use strict";var LANDER;!function(t){var e;[].forEach&&window.addEventListener||(window.location.href="http://lander3/public/front/pages/badbrowser.php"),(e=document.createElement("script")).src="http://lander3/public/front/js/gtm.min.js",console.log(Date.now()),document.head.appendChild(e);var r=function(){function t(t){void 0===t&&(t=[]),console.log(Date.now()),this.ga=t,this.setLanderParams(),this.dictionary={ru:{sending:"Отправка...",widgetFormPrivacyLabel:'Я&nbsp;даю согласие на&nbsp;обработку персональных данных, согласен на&nbsp;получение информационных рассылок от&nbsp;Университета «Синергия» и&nbsp;соглашаюсь c&nbsp;<a href="#privacy" class="lander-widget-form-privacy__link">политикой конфиденциальности</a>.',requiredField:"Обязательное поле",invalidName:"Введите корректное имя",invalidPhone:"Введите корректный телефон",invalidEmail:"Введите корректный адрес E-mail",invalidMask:"Введите корректное значение",invalidNumber:"Это поле может содержать только цифры"},en:{sending:"Sending...",widgetFormPrivacyLabel:'I&nbsp;give my&nbsp;consent to&nbsp;the processing of&nbsp;personal data, I&nbsp;also agree to&nbsp;receivе information updates from the Synergy University and agree to&nbsp;the <a href="#privacy" class="lander-widget-form-privacy__link">privacy policy</a>.',requiredField:"Field is required",invalidName:"Please enter a&nbsp;valid name",invalidPhone:"Please enter a&nbsp;valid phone",invalidEmail:"Please enter a&nbsp;valid email",invalidMask:"Please enter a&nbsp;valid value",invalidNumber:"Это поле может содержать только цифры"},kz:{sending:"Жіберу..."},cn:{sending:"发送"},es:{sending:"Envío..."}},this.depedences=[{name:"jQuery",url:"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js",required:!0,check:"function"==typeof window.jQuery,afterLoad:function(){},childrens:[{name:"inputmask",url:"https://cdnjs.cloudflare.com/ajax/libs/jquery.inputmask/3.3.4/jquery.inputmask.bundle.min.js",required:!0,check:"function"==typeof window.jQuery&&$.fn.inputmask,childrens:[{name:"phoneCodes",url:"https://cdnjs.cloudflare.com/ajax/libs/jquery.inputmask/3.3.4/phone-codes/phone.min.js",childrens:[],required:!0,loaded:!1},{name:"phoneCodesAddon",url:"https://syn.su/js/phone-addon.js",childrens:[],required:!0,loaded:!1}],loaded:!1},{name:"fancybox",url:"https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js",required:!0,check:"function"==typeof window.jQuery&&window.jQuery.fn.fancybox,childrens:[],loaded:!1}],loaded:!1},{name:"url",url:"https://cdnjs.cloudflare.com/ajax/libs/js-url/2.5.0/url.min.js",required:!0,check:window.url,childrens:[],loaded:!1},{name:"cookie",url:"https://cdnjs.cloudflare.com/ajax/libs/cookie.js/1.2.2/cookie.min.js",required:!0,check:window.cookie,childrens:[],loaded:!1},{name:"md5",url:"https://cdnjs.cloudflare.com/ajax/libs/blueimp-md5/2.8.0/js/md5.min.js",required:!0,check:window.md5,childrens:[],loaded:!1},{name:"fancyboxCss",url:"https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/css/jquery.fancybox.min.css",childrens:[],check:"function"==typeof window.jQuery&&window.jQuery.fn.fancybox,loaded:!1},{name:"landerCss",url:this.params.baseUrl+"/css/lander.css",childrens:[],loaded:!1}],this.widgets={formPrivacy:'\t\t\t\t<div class="lander-widget-form-privacy">\t\t\t\t\t<div class="lander-widget-form-privacy__content">\t\t\t\t\t\t<input \t\t\t\t\t\t\ttype="checkbox" \t\t\t\t\t\t\tname="personalDataAgree"\t\t\t\t\t\t\tclass="lander-widget-form-privacy__checkbox">\t\t\t\t\t\t<label class="lander-widget-form-privacy__label"></label>\t\t\t\t\t</div>\t\t\t\t</div>\t\t\t',formInfo:'\t\t\t\t<table class="lander-widget-form-info"></table>\t\t\t'},this.lang=this.getDocumentLanguage(),this.setLanderLang(this.lang),this.requiredResources=[],this.resourcesMap(this.depedences),this.loadResources(this.depedences)}return t.prototype.setLanderParams=function(){for(var t=document.querySelector('script[src*="lander"]').dataset.landerOptions.split(","),e=[],r=0;r<t.length;r++)if(t[r]){var n=t[r].split("=");e[n[0]]=n[1]}return this.params={action:e.action||"https://syn.su/lander.php",dev:e.dev||!1,baseUrl:e.baseUrl||"https://syn.su"},this.params},t.prototype.start=function(){return this.inited?this:(this.initUrl(),this.initUser(),this.checkRegion(),this.setDomainCookies().initForms().initPrivacyLinks().initFormPrivacyListener().validateFormListener().initFormSubmit().initFormHelper().initUtils(),this.params.dev&&this.initDevTools(),this.initAutoSubmit(),this.inited=!0,this)},t.prototype.initUtils=function(){return this.initDefaultFancybox().initDefaultScroll(),this},t.prototype.initDefaultFancybox=function(){return $(document).on("click",".lander-fancybox",function(t){var e=$(t.currentTarget);return $.fancybox(e,{maxWidth:1200,autoResize:!0,helpers:{media:{},overlay:{locked:!1}}}),!1}),this},t.prototype.initDefaultScroll=function(){return $(document).on("click",".lander-scroll",function(t){var e=$(t.currentTarget),r=$(e.attr("href"));if(r.length){var n=r.offset().top;return $("html, body").animate({scrollTop:n},1e3),!1}}),this},t.prototype.initForms=function(t){var e=this;return void 0===t&&(t=$(document)),$("form:not(.lander-off):not(.lander-inited)",t).each(function(t,r){var n=$(r);e.initFormInputs(n),/synergy.ru|synergyonline.ru|examples/i.test(window.location.hostname)&&e.initFormPrivacy(n),n.addClass("lander-inited")}),this},t.prototype.initFormInputs=function(t){var e=$('[name="name"]',t),r=$('[name="phone"]',t),n=$('[name="email"]',t);return r.filter(":not(data-lander-inputmask-inited)").attr("type","text").inputmask({alias:"phone"}).attr("data-lander-inputmask-inited",!0),e.val(this.getUserProp("name")),r.val(this.getUserProp("phone")),n.val(this.getUserProp("email")),this},t.prototype.initFormPrivacy=function(t){t=t.filter(":not(.lander-privacy-off):not(.lander-privacy-inited)");var e=$('[name="personalDataAgree"]',t);if(t.length<1||e.length>0)return this;var r=$(this.widgets.formPrivacy),n=$(".lander-widget-form-privacy__checkbox",r),a=$(".lander-widget-form-privacy__label",r),i="lander-widget-form-privacy-checkbox-"+Math.random();return n.attr("id",i),a.attr("for",i).html(this.currentLanguage.widgetFormPrivacyLabel),t.append(r),this},t.prototype.initFormPrivacyListener=function(){return $(document).on("lander:init-privacy-check change",'input[name="personalDataAgree"]',function(t){var e=$(t.currentTarget),r=e.closest("form"),n=$('button, input[type="submit"]',r),a=[];e.each(function(t,e){a.push(e.checked)}),-1==a.indexOf(!1)?n.removeAttr("disabled"):n.attr("disabled","disabled")}),$('input[name="personalDataAgree"]').trigger("lander:init-privacy-check"),this},t.prototype.getAjaxData=function(t){var e=t.attr("action");e=e?e.replace(/&amp;/g,"&"):this.params.action;for(var r=t.serializeArray(),n={},a=0;a<r.length;a++)n[r[a].name]=r[a].value;return[e,r,n,this.generateData(),url("?",e),this.url,cookie.all()]},t.prototype.initAutoSubmit=function(){var t=this;return/synergy.ru|synergyonline.ru|examples/i.test(window.location.hostname)&&$(document).on("focusout","form.lander-inited",function(e){e.preventDefault();var r=$(e.currentTarget),n=$('input[name="email"]',r);if(t.validateEmail(n.val(),n)&&!r.data("lander-auto-submit-block")){r.data("lander-auto-submit-block",!0);var a=t.getAjaxData(r),i=(a[0],a[1],a[2]),o=a[3],s=a[4],l=a[5],d=a[6],u=t.extendData(l,s,d,o,i);u.r="dump",$.ajax({url:"https://syn.su/v3/?r=dump",method:"POST",data:u,dataType:"JSON",success:function(t){console.log(t),r.data("lander-auto-submit-block",!1)}})}}),this},t.prototype.initFormHelper=function(){var t=this;return $(document).on("click","form.lander-inited",function(e){if(e.ctrlKey||e.cmdKey||e.metaKey){var r=$(e.currentTarget),n=t.getAjaxData(r),a=(n[0],n[1],n[2]),i=n[3],o=n[4],s=n[5],l=[{name:"Поля формы",data:a},{name:"Сгенерированые данные",data:i},{name:"Action формы",data:o},{name:"URL",data:s},{name:"Cookies",data:n[6]}],d=t.extendData(s,o,{},i,a);l.unshift({name:"Что уйдет в лендер",data:d});for(var u=$(t.widgets.formInfo),c=(u.attr("class"),0);c<l.length;c++){var p=l[c];u.append("\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<th colspan=2>\n\t\t\t\t\t\t\t"+p.name+"\n\t\t\t\t\t\t</th>\n\t\t\t\t\t</tr>");for(var m in p.data)p.data.hasOwnProperty(m)&&u.append("\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t"+m+"\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t"+p.data[m]+"\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>")}$.fancybox(u)}}),this},t.prototype.initFormSubmit=function(){var t=this;return $(document).on("submit","form.lander-inited",function(e){var r,n=$(e.target),a=t.getAjaxData(n),i=a[0],o=(a[1],a[2]),s=a[3],l=a[4],d=a[5],u=a[6];if(r=t.validateForm(n),$('[type="submit"],button',n).attr("disabled"))return!1;if(r.length){for(var c=0;c<r.length;c++)t.setInvalidInput(r[c]);return r[0].$input.focus(),!1}var p=t.extendData(d,l,u,s,o);t.saveUser(p.name,p.phone,p.email);var m,h=[];for(var f in p)if(p.hasOwnProperty(f)){var g={};g["gtm.element.dataset."+f]=p[f],h.push(g)}return h.push({"gtm.element.dataset.phone_md5":md5(p.phone)}),h.push({"gtm.element.dataset.email_md5":md5(p.email)}),(m=t.ga).push.apply(m,h),t.setFormLoading(n),$.ajax({url:i,method:"POST",data:p,success:function(e){t.submitSuccess(e,n)}}),!1}),this},t.prototype.submitSuccess=function(t,e){var r;this.ga.push({event:"gtm.formSubmit"});var n=!1;try{r=$(t)}catch(e){try{r=JSON.stringify(t),n=!0}catch(e){r="<div>"+t+"</div>",n=!1}}n?alert("TODO: JSON"):(this.unsetFormLoading(e),$(".lander-capcha",e).length?alert("TODO: CAPCHA"):$(".lander-sms",e).length?alert("TODO: SMS"):e.empty().html(r)),$(window).trigger("lander-send-success"),e.trigger("lander-send-success")},t.prototype.extendData=function(t,e,r,n,a){var i={};switch(window.location.hostname){case"synergyregions.ru":case"sbs.edu.ru":$.extend(!0,i,t,e,r,n,a);break;case"synergy.ru":case"synergyonline.ru":default:$.extend(!0,i,r,t,e,n,a)}return i},t.prototype.setDomainCookies=function(){var t=window.location.hostname;if(/synergyregions.ru|synergyglobal.ru/.test(t)){var e=0,r="GlobalPartner";"synergyregions.ru"==t&&(e=3,r="SynergyPartner");var n,a=new Date;a.setFullYear(a.getFullYear()+e),n=a.toGMTString();var i={};i[r]=this.url.partner,cookie.set(i,{path:"/",expires:n})}if(/synergy\.ru|synergyonline\.ru|synergyglobal\.ru|synergy\.mba|sbs\.edu\.ru|mosap\.ru|xn\-\-80aayoegldhg0a2a2j\.xn\-\-p1ai/.test(t)){var o={},s=cookie.all();!s.utm_source&&this.url.utm_source&&(o.utm_source=this.url.utm_source),!s.utm_medium&&this.url.utm_medium&&(o.utm_medium=this.url.utm_medium),!s.utm_campaign&&this.url.utm_campaign&&(o.utm_campaign=this.url.utm_campaign),!s.utm_content&&this.url.utm_content&&(o.utm_content=this.url.utm_content),!s.utm_term&&this.url.utm_term&&(o.utm_term=this.url.utm_term),cookie.set(o,{path:"/"})}return this},t.prototype.saveUser=function(t,e,r){return this.checkLocalStorage()?(t&&localStorage.setItem("name",t),e&&localStorage.setItem("phone",e),r&&localStorage.setItem("email",r),this):this},t.prototype.generateData=function(){var t="id_"+Math.random().toString(36).substr(2,9),e=t+Date.now(),r=cookie.all(),n=null;for(var a in r)if(/_pk_id/i.test(a)){n=r[a];break}return{guid:t,mergelead:e,lang:this.lang,refer:document.referrer,piwik_id:n,PAPVisitorId:r.PAPVisitorId||null,roistat_visit:r.roistat_visit||null,analytics_id:r._ga||null}},t.prototype.setFormLoading=function(t){return $('input:not([disabled="disabled"]), textarea:not([disabled="disabled"]), select:not([disabled="disabled"])',t).attr({"data-lander-input-disabled":"disabled",disabled:!0}),t.addClass("lander-form-sending"),$('[type="submit"]',t).addClass("lander-form-submit-sending").data("lander-value",$('[type="submit"]',t).val()).val(this.currentLanguage.sending),$("button",t).addClass("lander-form-submit-sending").data("lander-value",$("button",t).html()).html(this.currentLanguage.sending),this},t.prototype.unsetFormLoading=function(t){return $('input:not([data-lander-input-disabled!="disabled"]), textarea:not([data-lander-input-disabled!="disabled"]), select:not([data-lander-input-disabled!="disabled"])',t).attr("disabled",!1),t.removeClass("lander-form-sending"),$('[type="submit"]',t).removeClass("lander-form-submit-sending").val($('[type="submit"]',t).data("lander-value")),$("button",t).removeClass("lander-form-submit-sending").html($("button",t).data("lander-value")),this},t.prototype.validateFormListener=function(){var t=this;return $(document).on("change input focus","input.lander-invalid-input-error, \t\t\ttextarea.lander-invalid-input-error, \t\t\tselect.lander-invalid-input-error",function(e){var r,n=$(e.currentTarget).closest("form");if((r=t.validateForm(n)).length)for(var a=0;a<r.length;a++)t.setInvalidInput(r[a])}),this},t.prototype.validateForm=function(t){var e=this,r=[];return $("input, textarea, select",t).each(function(t,n){var a=$(n),i=a.attr("name"),o=a.data("lander-validate-mask"),s=!!a.attr("required"),l=a.val()||!!a.checked,d={$input:a,errorMessage:!1};if(s&&!l)d.errorMessage=e.currentLanguage.requiredField;else switch(i){case"name":e.validateName(l,a)||(d.errorMessage=e.currentLanguage.invalidName);break;case"phone":e.validatePhone(l,a)||(d.errorMessage=e.currentLanguage.invalidPhone);break;case"email":e.validateEmail(l,a)||(d.errorMessage=e.currentLanguage.invalidEmail);break;default:o&&!e.validateMask(l,o,a)&&(d.errorMessage=e.currentLanguage.invalidMask)}!1!==d.errorMessage?r.push(d):e.setValidInput(a)}),r},t.prototype.validateName=function(t,e){if("boolean"==typeof t)return!1;if("cn"==this.lang)return!0;return/^[\wа-яёJł∫łÅÃǺǻаάẫẮắẰằẴẵÄĄªäÅÄÀÁÂåãâàάâáàÂâãΆลฉสαจЂδßβҐґŗѓΔ∂ðgġℊΣĒēĔĕĖėĘЁеěĚęΈëêξÊÈξ€Єèé€ËÉ∑∑ẾЕỀỂỄєﻉeЄєέεℯзʒυนմuหųůύϋΰÙúÚΰùÛûửữüừŨũŪūŬŭűŮK∫รI{kใรlรκIร)รķเรǨќķĶЌJlJเ∫lΛλภJI∫५ณmრฬʍ₥றभҢทฑηήnñµņңňĤĦΉŀlΉЊℋØøอσőǾŌΘŏōฮθทฑnГlթþקρÞζçÇ¢çςČċĊĉςĈćĆċčॡТדŦŤ†TτΐŢყע¥γЎұצφאхχ×ჯԱųŲҹԿ५ώωա๒ьIзЭәӘศ \-\'\`]{2,100}$/i.test(t)},t.prototype.validatePhone=function(t,e){if("boolean"==typeof t)return!1;if(e&&e.data("lander-inputmask-inited"))return e.inputmask("isComplete");return/^[0-9\- \(\)]{5,20}/i.test(t)},t.prototype.validateEmail=function(t,e){if("boolean"==typeof t)return!1;return/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i.test(t)},t.prototype.validateMask=function(t,e,r){return"boolean"!=typeof t&&new RegExp(e,"i").test(t)},t.prototype.setInvalidInput=function(t){var e=t.$input;if(e.addClass("lander-invalid-input-error"),"checkbox"==e.attr("type"))return this;var r=e.next();return r.hasClass("lander-invalid-input-error-label")?r.html(t.errorMessage):e.after('<label class="lander-invalid-input-error-label">'+t.errorMessage+"</label>"),this},t.prototype.setValidInput=function(t){if(t.removeClass("lander-invalid-input-error").addClass("lander-valid-input"),"checkbox"==t.attr("type"))return this;var e=t.next();return e.hasClass("lander-invalid-input-error-label")&&e.remove(),this},t.prototype.initUrl=function(){return this.url=url("?")||{},this.url},t.prototype.initUser=function(){var t=cookie.all(),e={name:t.name,phone:t.phone,email:t.email},r=this.getLocalStorage(["name","phone","email"]);return this.user=$.extend(!0,e,r),this.user},t.prototype.getLocalStorage=function(t){void 0===t&&(t=[]);var e={};return this.checkLocalStorage()&&(e=t.length?JSON.parse(JSON.stringify(localStorage,t)):JSON.parse(JSON.stringify(localStorage))),e},t.prototype.checkLocalStorage=function(){try{if("object"==typeof localStorage&&"function"==typeof localStorage.setItem&&"function"==typeof localStorage.getItem)return!0}catch(t){return!1}return!1},t.prototype.getUserProp=function(t){return this.user[t]||""},t.prototype.initPrivacyLinks=function(){var t=this;return $(document).on("click",'[href="#privacy"]',function(e){var r="http://synergy.ru/lp/_chunk/privacy.php?lang="+t.lang+"&date="+Date.now();return $.fancybox({href:r,type:"ajax",maxWidth:910,autoResize:!0,padding:0,wrapCSS:"lander-widget-privacy",helpers:{overlay:{locked:!1}}}),!1}),this},t.prototype.checkRegion=function(){return this},t.prototype.initDevTools=function(){return this},t.prototype.getDocumentLanguage=function(){return document.documentElement.lang||"ru"},t.prototype.setLanderLang=function(t){return void 0===t&&(t="ru"),this.dictionary[t]?(this.currentLanguage=this.dictionary[t],this.currentLanguage):(console.error("В словаре лендера нет языка "+t),!1)},t.prototype.loadResources=function(t,e){var r=this;void 0===e&&(e=!1);for(var n=function(n){var i=t[n];Array.isArray(i.childrens)&&!i.childrens.length?a.loadExternal({name:i.name,url:i.url,addRand:e,full:i},function(){i.loaded=!0,r.resourceLoaded(i.name)}):a.loadExternal({name:i.name,url:i.url,addRand:e,full:i},function(){i.loaded=!0,r.resourceLoaded(i.name),r.loadResources(i.childrens,e)})},a=this,i=0;i<t.length;i++)n(i)},t.prototype.resourcesMap=function(t){for(var e=0;e<t.length;e++){var r=t[e];Array.isArray(r.childrens)&&(!r.childrens.length&&r.required?this.requiredResources.push(r.name):r.childrens.length&&(r.required&&this.requiredResources.push(r.name),this.resourcesMap(r.childrens)))}return this.requiredResources},t.prototype.resourceLoaded=function(t){var e=this.requiredResources.indexOf(t);return-1!==e&&this.requiredResources.splice(e,1),0==this.requiredResources.length&&this.start(),this},t.prototype.loadExternal=function(t,e){if("function"==typeof t.full.afterLoad&&t.full.afterLoad(),t.full.check)e();else{t.name;var r,n=t.url,a=t.addRand,i=n.split(".").slice(-1)[0];switch(a&&(n+="?nocache="+Math.random()),i){case"js":(r=document.createElement("script")).setAttribute("src",n),r.setAttribute("type","text/javascript");break;case"css":(r=document.createElement("link")).setAttribute("href",n),r.setAttribute("rel","stylesheet")}document.body.appendChild(r),"function"==typeof e&&(r.onload=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.executed||(this.executed=!0,e.apply(void 0,["onload"].concat(t)))},r.onerror=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.executed||(this.executed=!0,e.apply(void 0,["onerror"].concat(t)))},r.onreadystatechange=function(){var t=this;"complete"!=this.readyState&&"loaded"!=this.readyState||setTimeout(function(){t.onload()},0)})}},t}();document.addEventListener("DOMContentLoaded",function(){window.LANDER=new r(window.dataLayer)})}(LANDER||(LANDER={}));
//# sourceMappingURL=lander3.0.min.js.map